{
  "module_info": {
    "name": "History and Preferences Agent",
    "node_id": "history_preferences",
    "description": "Gerencia histórico de interações e preferências do usuário para fornecer contexto personalizado",
    "version": "1.0.0"
  },
  "memory_configuration": {
    "max_history_items": 50,
    "history_retention_days": 90,
    "preference_categories": [
      "visualization",
      "analysis",
      "reporting",
      "communication"
    ]
  },
  "interaction_types": {
    "query": {
      "name": "Consulta SQL",
      "description": "Perguntas que geram queries SQL",
      "track_fields": [
        "query_type",
        "tables_used",
        "filters_applied",
        "date_range"
      ]
    },
    "faq": {
      "name": "Pergunta FAQ",
      "description": "Perguntas sobre conhecimentos gerais da empresa",
      "track_fields": [
        "topic",
        "category",
        "answered"
      ]
    },
    "analysis": {
      "name": "Análise Estatística",
      "description": "Solicitações de análise e insights",
      "track_fields": [
        "analysis_type",
        "metrics",
        "visualizations"
      ]
    }
  },
  "preference_types": {
    "visualization": {
      "name": "Preferências de Visualização",
      "description": "Como o usuário prefere ver os dados",
      "options": {
        "chart_type": [
          "bar",
          "line",
          "pie",
          "table",
          "mixed"
        ],
        "color_scheme": [
          "blue",
          "green",
          "purple",
          "corporate"
        ],
        "detail_level": [
          "summary",
          "detailed",
          "complete"
        ]
      },
      "defaults": {
        "chart_type": "bar",
        "color_scheme": "corporate",
        "detail_level": "detailed"
      }
    },
    "analysis": {
      "name": "Preferências de Análise",
      "description": "Tipo de análise preferida pelo usuário",
      "options": {
        "time_period": [
          "daily",
          "weekly",
          "monthly",
          "quarterly",
          "yearly"
        ],
        "comparison": [
          "none",
          "previous_period",
          "same_period_last_year"
        ],
        "metrics_priority": [
          "revenue",
          "volume",
          "growth",
          "efficiency"
        ]
      },
      "defaults": {
        "time_period": "monthly",
        "comparison": "previous_period",
        "metrics_priority": "revenue"
      }
    },
    "reporting": {
      "name": "Preferências de Relatórios",
      "description": "Como o usuário prefere receber relatórios",
      "options": {
        "format": [
          "text",
          "structured",
          "executive"
        ],
        "include_recommendations": [
          true,
          false
        ],
        "verbosity": [
          "concise",
          "moderate",
          "detailed"
        ]
      },
      "defaults": {
        "format": "structured",
        "include_recommendations": true,
        "verbosity": "moderate"
      }
    },
    "communication": {
      "name": "Preferências de Comunicação",
      "description": "Estilo de comunicação preferido",
      "options": {
        "tone": [
          "formal",
          "casual",
          "technical"
        ],
        "language_style": [
          "simple",
          "professional",
          "technical"
        ],
        "use_emojis": [
          true,
          false
        ]
      },
      "defaults": {
        "tone": "professional",
        "language_style": "professional",
        "use_emojis": false
      }
    }
  },
  "context_fields": {
    "recent_queries": {
      "description": "Últimas perguntas feitas pelo usuário",
      "max_items": 10
    },
    "common_topics": {
      "description": "Tópicos mais frequentemente consultados",
      "tracked": true
    },
    "session_info": {
      "description": "Informações da sessão atual",
      "fields": [
        "start_time",
        "interaction_count",
        "projeto_atual"
      ]
    },
    "user_patterns": {
      "description": "Padrões identificados no comportamento do usuário",
      "fields": [
        "peak_hours",
        "favorite_metrics",
        "query_complexity"
      ]
    }
  },
  "learning_rules": {
    "auto_learn_preferences": true,
    "min_interactions_for_pattern": 5,
    "confidence_threshold": 0.7,
    "update_strategy": "incremental"
  },
  "module_tracking": {
    "description": "Rastreamento detalhado de execução de cada módulo do grafo",
    "enabled": true,
    "modules": {
      "intent_validator": {
        "name": "Intent Validator Agent",
        "node_id": 0,
        "tracked_fields": [
          "intent_valid",
          "intent_category",
          "intent_reason",
          "is_special_case"
        ]
      },
      "history_preferences": {
        "name": "History & Preferences Agent",
        "node_id": 1,
        "tracked_fields": [
          "has_user_context",
          "context_history_count",
          "context_preferences_count",
          "context_patterns_count"
        ]
      },
      "router": {
        "name": "Router Agent",
        "node_id": 2,
        "tracked_fields": [
          "route",
          "is_special_case",
          "special_type",
          "faq_match_similarity",
          "faq_match_question"
        ]
      },
      "generator": {
        "name": "Generator Agent",
        "node_id": 3,
        "tracked_fields": [
          "sql_query",
          "source",
          "query_complexity"
        ]
      },
      "responder": {
        "name": "Responder Agent",
        "node_id": 4,
        "tracked_fields": [
          "resposta_final",
          "execution_time",
          "erro",
          "query_executed",
          "result_count"
        ]
      }
    }
  }
}